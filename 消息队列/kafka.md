
# 概念

# 小知识点
## 消费者开始消费的位置
消费者从头开始消费某个队列的消息需要满足两个条件：
* 1.使用一个全新的"group.id"（就是之前没有被任何消费者使用过）
* 2.指定"auto.offset.reset"参数的值为earliest，如果该值设置为latest，那么消费者不会消费之前的消息，而是从接入之后进来的新消息开始消费。

注意：从kafka-0.9版本及以后，kafka的消费者组和offset信息就不存zookeeper了，而是存到broker服务器上，所以，如果你为某个消费者指定了一个消费者组名称（group.id），那么，一旦这个消费者启动，这个消费者组名和它要消费的那个topic的offset信息就会被记录在broker服务器上。


## kafka中队列的分片数越多速度越快？
（这部分节选自：https://www.jianshu.com/p/cdfc3df9e4c6）
在kafka中，partition（分片）和队列的关系就像泳池和泳道，每个泳道都可以独立的传输消息。而kafka的吞吐量在资源充足的情况下的确是分片越多，速度越快。但是前提是资源充足即节点数量，这个很重要。

然而更多的分片意味着更高的开销：
* 1.越多的分区需要打开更多的文件句柄（在kafka的broker中，每个分区都会对照着文件系统的一个目录）
* 2.更多的分区会导致端对端的延迟（主要是副本的同步延迟，在一个broker上的副本从其他broker的leader上复制数据的时候只会开启一个线程）
* 3.越多的partition意味着需要更多的内存
* 4.越多的partition会导致更长时间的恢复期
通常情况下，越多的partition会带来越高的吞吐量，但是同时也会给broker节点带来相应的性能损耗和潜在风险，虽然这些影响很小，但不可忽略，因此需要根据自身broker节点的实际情况来设置partition的数量以及replica的数量。

